<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quran Viewer</title>
    <style>
        /* Reset some styles for consistency */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background-color: #f4f4f9;
            color: #333;
            padding: 20px;
            text-align: center;
        }

        .container {
            max-width: 1100px;
            margin: auto;
            background-color: #ffffff;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        h1 {
            font-size: 2rem;
            margin-bottom: 20px;
            color: #1f3a5f;
        }

        select, button {
            font-size: 1rem;
            padding: 10px;
            margin: 15px 0;
            width: 100%;
            max-width: 300px;
            margin-top: 10px;
        }

        #verseText {
            font-size: 2rem;
            font-family: 'Amiri', serif;
            color: #2c3e50;
            margin-top: 30px;
        }

        .translation {
            margin-top: 20px;
            font-size: 1.2rem;
            color: #34495e;
            line-height: 1.5;
        }

        .audio {
            margin-top: 30px;
        }

        .audio button {
            padding: 12px 25px;
            font-size: 1rem;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 5px;
        }

        .tafsir {
            margin-top: 20px;
            font-style: italic;
            color: #7f8c8d;
            line-height: 1.5;
        }

        .select-container {
            margin-bottom: 25px;
        }

        .select-container label {
            font-size: 1.2rem;
            color: #34495e;
            display: block;
            margin-bottom: 5px;
        }

        .select-container select {
            font-size: 1rem;
            padding: 10px;
            width: 100%;
            max-width: 300px;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>Quran Viewer</h1>

        <div class="select-container">
            <label for="chapter">Select Chapter (Surah):</label>
            <select id="chapter" onchange="loadVerses()">
                <!-- Dynamic chapter options will appear here -->
            </select>
        </div>

        <div class="select-container">
            <label for="verse">Select Verse:</label>
            <select id="verse" onchange="loadVerse()">
                <!-- Dynamic verse options will appear here -->
            </select>
        </div>

        <div class="select-container">
            <label for="translation">Select Translation:</label>
            <select id="translation" onchange="loadVerse()">
                <option value="en">English</option>
                <option value="fr">French</option>
                <option value="ar">Arabic</option>
            </select>
        </div>

        <div class="select-container">
            <label for="reciter">Select Reciter:</label>
            <select id="reciter" onchange="loadVerse()">
                <option value="minshawi">Minshawi</option>
                <option value="yasser">Yasser Al-Dosari</option>
            </select>
        </div>

        <div id="verseText">Select a chapter and verse</div>

        <div id="translationText" class="translation">Translation will appear here</div>

        <div class="audio">
            <button id="audioBtn">Play Recitation</button>
        </div>

        <div id="tafsirText" class="tafsir">Tafsir (Explanation) will appear here</div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        let quranData = {};  // Store Quran content
        let currentChapter = 1;
        let currentVerse = 1;
        let currentTranslation = 'en';  // Default to English
        let currentReciter = 'minshawi';  // Default reciter

        // Fetch chapters and load them into the select dropdown
        function loadChapters() {
            $.ajax({
                url: 'https://api.alquran.cloud/v1/surah',
                method: 'GET',
                success: function(response) {
                    let chapters = response.data;
                    let chapterSelect = $('#chapter');
                    chapters.forEach((chapter) => {
                        chapterSelect.append(new Option(chapter.englishName, chapter.number));
                    });
                    loadVerses(); // Load verses for the first chapter
                }
            });
        }

        // Fetch verses based on the selected chapter
        function loadVerses() {
            currentChapter = $('#chapter').val();
            $.ajax({
                url: `https://api.alquran.cloud/v1/surah/${currentChapter}`,
                method: 'GET',
                success: function(response) {
                    let verseCount = response.data.ayahCount;
                    let verseSelect = $('#verse');
                    verseSelect.empty();
                    for (let i = 1; i <= verseCount; i++) {
                        verseSelect.append(new Option(i, i));
                    }
                    loadVerse(); // Load the first verse
                }
            });
        }

        // Fetch the selected verse, its translation, and tafsir
        function loadVerse() {
            currentVerse = $('#verse').val();
            currentTranslation = $('#translation').val();  // Get selected translation
            currentReciter = $('#reciter').val();  // Get selected reciter

            $.ajax({
                url: `https://api.alquran.cloud/v1/ayah/${currentChapter}/${currentVerse}`,
                method: 'GET',
                success: function(response) {
                    let verseData = response.data;
                    // Show Arabic verse text
                    $('#verseText').html(`<p><strong>Arabic:</strong> ${verseData.text}</p>`);

                    // Show translation
                    $.ajax({
                        url: `https://api.alquran.cloud/v1/ayah/${currentChapter}/${currentVerse}?translation=${currentTranslation}`,
                        method: 'GET',
                        success: function(translationResponse) {
                            $('#translationText').html(`<p><strong>Translation:</strong> ${translationResponse.data.translation}</p>`);
                        }
                    });

                    // Fetch tafsir (explanation)
                    fetchTafsir();

                    // Load audio recitation
                    loadAudio(currentChapter, currentVerse);
                }
            });
        }

        // Fetch tafsir for the selected verse
        function fetchTafsir() {
            $.ajax({
                url: `https://api.alquran.cloud/v1/tafsir/${currentChapter}/${currentVerse}`,
                method: 'GET',
                success: function(response) {
                    $('#tafsirText').text(response.data.text || "No tafsir available.");
                },
                error: function() {
                    $('#tafsirText').text("Unable to fetch tafsir.");
                }
            });
        }

        // Load recitation for the selected verse and reciter
        function loadAudio(chapter, verse) {
            const audioUrl = `https://verses.quranicaudio.com/${currentReciter}/${chapter}/${verse}.mp3`;
            $('#audioBtn').off().on('click', function() {
                const audio = new Audio(audioUrl);
                audio.play();
            });
        }

        // Initial data load
        loadChapters();
    </script>

</body>
</html>

